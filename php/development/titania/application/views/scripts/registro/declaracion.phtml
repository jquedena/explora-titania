<script type="text/javascript" src="<?php echo $this->util()->getPath(); ?>js/registro/declaracion.js"></script>


<input type="hidden" id="hdnIdDeclaracion" value="<?php echo $this->mhresum; ?>"/>
<input type="hidden" id="hdnIdPersona" value="<?php echo $this->mperson; ?>"/>
<input type="hidden" id="hdnAnioTermino" value="<?php echo $this->cperiod; ?>"/>
<table class="ui-table-panelLayout">
    <tr>
        <td colspan="2" style="text-align: right;font-weight: bold;">La modificaci&oacute;n de esta declaraci&oacute;n entra en vigencia a partir del a&ntilde;o:</td>
        <td><input class="ui-text" style="width: 80px; text-align: center;" id="dtpFechaVigencia"/></td>
    </tr>
    <tr>
        <td colspan="3" style="padding: 2px;"><hr/></td>
    </tr>
    <tr>
        <td style="text-align: right;width: 130px">Declaraci&oacute;n Jurada:</td>
        <td><input class="ui-text" style="width: 100px" id="txtNroDeclaracion"></td>
        <td>&nbsp;</td>
    </tr>
    <tr>
	    <td>
	    	<div><table border="0">
	    		<tr>
	    		<td style="text-align: right">Fecha:</td>
	        	<td><input class="ui-text" style="width: 80px; text-align: center;" id="dtpFechaDeclaracion"/></td>
			        <td>&nbsp;</td>
			    </tr>
			    <tr>
			        <td style="text-align: right">Motivo:</td>
			        <td id="cellMotivo"><select style="width: 240px;" id="cboMotivo"><?php echo $this->util()->getComboContenedor('1000000004', null); ?></select></td>
			        <td>&nbsp;</td>
			    </tr>
			    <tr>
			        <td style="text-align: right;vertical-align: top;">Observaci&oacute;n:</td>
			        <td colspan="2"><textarea class="ui-text" class="jquery_ckeditor" cols="80" id="txtObservacion" name="txtObservacion" rows="10"></textarea></td>
			    </tr>
			    <tr>
			        <td colspan="3" style="text-align: right;">
			            <button id="btnAceptarDeclaracion">Aceptar</button>
			            <button id="btnCancelarDeclaracion">Cancelar</button>
			        </td>
			        </tr>
			        </table>
	         </div>  
	      </td>
	      <td id="dvBajalt">
	     		<div><table border="0" width="100%">
	    		<tr>
		    		<td>
				    
				    			    <table id="list" width="100%">
				    			    <tr><td/></tr>
				    			    </table>
			    					<div id="pager" ></div>
	    				
						
	
		    		</td>
	    		</tr>
	    		<tr>
		    		<td>
				    
				    			    <table id="list2" width="100%">
				    			    <tr><td/></tr>
				    			    </table>
			    					<div id="pager2" ></div>
	    				
						
	
		    		</td>
	    		</tr>
	    		
	    		
	    		</table>
	    		</div>
	      
	      </td>
        
    </tr>
</table>
<script type="text/javascript">
    $(function(){

    
        
        var config = {
            skin:'v2'
            , toolbar: [
                ['Bold','Italic','Underline','-','NumberedList','BulletedList','-','Outdent','Indent','-','Undo','Redo','-','HorizontalRule','-','Blockquote','CreateDiv','-','JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock','-','TextColor','BGColor'],
                ['UIColor']
            ]
        }, _cmotivo = "";
        
        var hEd = CKEDITOR.instances['txtObservacion'];
        if (hEd) {
            CKEDITOR.remove(hEd);
        }
        CKEDITOR.replace('txtObservacion', config);
        
        $("#dtpFechaDeclaracion, #dtpFechaVigencia").datepicker({
            dateFormat: "dd/mm/yy",
            showOn: "button",
            buttonImage: pathImage + "calendar.gif",
            buttonImageOnly: true
        });
        
        themeComboBox("#cellMotivo select");
        
        $("#btnAceptarDeclaracion").button({
            icons: {primary:'ui-icon-check'}
        }).bind("click", function(){
            mhresum = {
	        	idsigma: $("#hdnIdDeclaracion").val(),
	        	ctipdat: "1000000002", /* Registro Tributario */
	        	vnrodoc: $("#hdnId").val(),
	        	dfecdoc: $("#dtpFechaDeclaracion").val(),
	        	cmotivo: _cmotivo,
	        	ctipdoc: "1000000021", /* Declaracion Jurada */
	        	vnrodjj: $("#txtNroDeclaracion").val(),
	        	vobserv: $("#txtObservacion").val(),
	        	nestado: "1",
	        	cperini: $("#dtpFechaVigencia").val(),
	        	cperfin: $("#hdnAnioTermino").val(),
	        	mperson: $("#hdnIdPersona").val()
        	};
        	console.log(mhresum);
            closeDialog("jqDialog1");
        });
        $("#btnCancelarDeclaracion").button({
            icons: {primary:'ui-icon-arrowreturnthick-1-w'}
        }).bind("click", function(){
            closeDialog("jqDialog1");
        });

	  function verificar(){    		
    		//alert(""+$("#txtMotivo").val());
    		//1000000008 --Compra
    		//1000000009 --Venta
	  		
			if ( $("#txtMotivo").val()=='COMPRA' ||  $("#txtMotivo").val()=='VENTA' ){
				$("#dvBajalt").show();			  		
    		}else{
    			$("#dvBajalt").hide();		
    		}
	  }		 

        $("#txtMotivo").bind("autocompleteselect", verificar);
        $("#txtMotivo").bind("autocompletechange", verificar);

    	$("#dvBajalt").hide();		
	      	
        
    });
</script>